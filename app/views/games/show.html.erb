<script>
$( document ).ready(function() {
    $('#myModal').modal('show');
    console.log( "ready!" );
});

  $(function() {
    $('.drag').draggable({
      revert: "invalid"
    });
    $('.drag a').bind('click', function(e){
        e.preventDefault();
    });
    $('.drop').droppable({
      drop: function(event, ui){
        var desiredUrl = $(ui.draggable.context.innerHTML).attr("href");
        var x = $(this).data('square-x');
        var y = $(this).data('square-y');
        console.log(x, y);
        var piece = { piece: {
          horizontal_position: x,
          vertical_position: y
        } };
        $(ui.draggable).detach().css({top: 0,left: 0}).appendTo(this);
        $.ajax({
          type: 'PUT',
          url: desiredUrl,
          data: piece,
          dataType: 'json'
        }).done(function(){
          window.location.reload();
        
        });
      }
    });
  });
</script>

<div class="board">
  <% board = Array.new(8) %>
  <% board.map! {Array(1..8)}%>
  <% board.each_with_index do |row, index| %>
    <div class="row">
      <% row.each do |x| %>
        <% y = index + 1 %>
        <div class='drop' data-square-x=<%= x %> data-square-y=<%= y %>>
          <% y = index + 1 %>
          <% location = locate_piece(x, y) %>
          <% if !location.nil? %>
            <div class='drag'>
              <%= link_to render_piece(x, y), piece_path(location) %>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>
  <% end %>
</div>

<div class="modal fade" id=<%= pawn_promo %> tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Pawn Promotion</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
        <form action="#" class="promotion-choice">
          <div class="promo-selection-container">
            <% ['Queen', 'Bishop', 'Rook', 'Knight'].each do |name| %>
              <div class="promo-selection-choice">              
                <label for="<%= piece_name = "black#{name}.png" %>">

                <%= image_tag(piece_name, class: 'piece-image') %>
                  
                <%= name %>
                </label>
                <input type="radio" name="p_type" value="<%= name %>" id="<%= name %>">
              </div>
            <% end %>
            <input type="submit">
        </div>
          
      </form>
      </div>
    </div>
  </div>
</div>

<div>
something
<%= @data %>
</div>